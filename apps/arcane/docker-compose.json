{
  "schemaVersion": 2,
  "$schema": "https://schemas.runtipi.io/dynamic-compose.json",
  "services": [
    {
      "name": "arcane",
      "image": "ghcr.io/getarcaneapp/arcane:latest",
      "internalPort": 3552,
      "isMain": true,
      "volumes": [
        {
          "hostPath": "${APP_DATA_DIR}/data",
          "containerPath": "/app/data"
        }
      ],
      "environment": {
        "PUID": "1000",
        "PGID": "1000",
        "ENCRYPTION_KEY": "${ENCRYPTION_KEY}",
        "JWT_SECRET": "${JWT_SECRET}",
        "DOCKER_HOST": "tcp://docker-socket-proxy:2375",
        "APP_URL": "${APP_URL}"
      },
      "user": "1000:1000",
      "depends_on": [
        "docker-socket-proxy"
      ],
      "healthCheck": {
        "test": "curl -fsS http://localhost:3552/api/health || exit 1",
        "interval": "10s",
        "timeout": "3s",
        "retries": 5,
        "startPeriod": "15s"
      }
    },
    {
      "name": "docker-socket-proxy",
      "image": "tecnativa/docker-socket-proxy:latest",
      "internalPort": 2375,
      "volumes": [
        {
          "hostPath": "/var/run/docker.sock",
          "containerPath": "/var/run/docker.sock:ro"
        }
      ],
      "environment": {
        "EVENTS": "1",
        "PING": "1",
        "VERSION": "1",
        "AUTH": "0",
        "SECRETS": "0",
        "POST": "1",
        "CONTAINERS": "1",
        "EXEC": "1",
        "IMAGES": "1",
        "INFO": "1",
        "NETWORKS": "1",
        "VOLUMES": "1"
      },
      "security_opt": [
        "no-new-privileges:true"
      ],
      "cap_add": [
        "SYS_ADMIN"
      ]
    }
  ]
}
